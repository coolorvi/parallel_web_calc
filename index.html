<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Распределённый калькулятор</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        input, button { margin: 5px; padding: 10px; }
        #results { margin-top: 20px; }
    </style>
</head>
<body>
    <h2>Распределённый калькулятор</h2>
    <label>Аргумент 1: <input type="text" id="arg1"></label>
    <label>Операция: 
        <select id="operation">
            <option value="+">+</option>
            <option value="-">-</option>
            <option value="*">*</option>
            <option value="/">/</option>
        </select>
    </label>
    <label>Аргумент 2: <input type="text" id="arg2"></label>
    <button onclick="sendExpression()">Отправить</button>
    
    <h3>Результаты</h3>
    <div id="results"></div>
    
    <script>
        const API_BASE = "http://localhost:8080";

        async function sendExpression() {
            const arg1 = document.getElementById("arg1").value;
            const arg2 = document.getElementById("arg2").value;
            const operation = document.getElementById("operation").value;

            const response = await fetch(`${API_BASE}/expressions`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ arg1, arg2, operation })
            });
            const data = await response.json();
            alert("Выражение отправлено! ID: " + data.id);
            fetchResults();
        }

        async function fetchResults() {
            const response = await fetch(`${API_BASE}/results`);
            const results = await response.json();
            const resultsDiv = document.getElementById("results");
            resultsDiv.innerHTML = "";
            results.forEach(res => {
                resultsDiv.innerHTML += `<p>ID: ${res.id}, Результат: ${res.result}</p>`;
            });
        }

        setInterval(fetchResults, 5000);
    </script>
</body>
</html>
